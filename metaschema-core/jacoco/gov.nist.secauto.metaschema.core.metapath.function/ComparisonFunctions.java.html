<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ComparisonFunctions.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Metaschema Core API</a> &gt; <a href="index.source.html" class="el_package">gov.nist.secauto.metaschema.core.metapath.function</a> &gt; <span class="el_source">ComparisonFunctions.java</span></div><h1>ComparisonFunctions.java</h1><pre class="source lang-java linenums">/*
 * SPDX-FileCopyrightText: none
 * SPDX-License-Identifier: CC0-1.0
 */

package gov.nist.secauto.metaschema.core.metapath.function;

import gov.nist.secauto.metaschema.core.metapath.ISequence;
import gov.nist.secauto.metaschema.core.metapath.InvalidTypeMetapathException;
import gov.nist.secauto.metaschema.core.metapath.function.library.FnNot;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IAnyAtomicItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IBase64BinaryItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IBooleanItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDateItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDateTimeItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDayTimeDurationItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDecimalItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IDurationItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IIntegerItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.INumericItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IStringItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IUntypedAtomicItem;
import gov.nist.secauto.metaschema.core.metapath.item.atomic.IYearMonthDurationItem;

import java.util.Locale;

import edu.umd.cs.findbugs.annotations.NonNull;

<span class="fc" id="L29">@SuppressWarnings({ &quot;PMD.GodClass&quot;, &quot;PMD.CyclomaticComplexity&quot; })</span>
public final class ComparisonFunctions {
  /**
   * Comparison operators.
   */
<span class="fc" id="L34">  public enum Operator {</span>
    /**
     * An equal comparison.
     */
<span class="fc" id="L38">    EQ,</span>
    /**
     * A not equal comparison.
     */
<span class="fc" id="L42">    NE,</span>
    /**
     * A less than comparison.
     */
<span class="fc" id="L46">    LT,</span>
    /**
     * A less than or equal comparison.
     */
<span class="fc" id="L50">    LE,</span>
    /**
     * A greater than comparison.
     */
<span class="fc" id="L54">    GT,</span>
    /**
     * A greater than or equal comparison.
     */
<span class="fc" id="L58">    GE;</span>
  }

  private ComparisonFunctions() {
    // disable construction
  }

  /**
   * Compare the two items using the provided {@code operator}.
   *
   * @param leftItem
   *          the first item to compare
   * @param operator
   *          the comparison operator
   * @param rightItem
   *          the second item to compare
   * @return the result of the comparison
   */
  @NonNull
  public static IBooleanItem valueCompairison(@NonNull IAnyAtomicItem leftItem, @NonNull Operator operator,
      @NonNull IAnyAtomicItem rightItem) {
<span class="fc" id="L79">    return compare(leftItem, operator, rightItem);</span>
  }

  /**
   * Compare the sets of atomic items.
   *
   * @param leftItems
   *          the first set of items to compare
   * @param operator
   *          the comparison operator
   * @param rightItems
   *          the second set of items to compare
   * @return a or an empty {@link ISequence} if either item is {@code null}
   */
  @NonNull
  public static IBooleanItem generalCompairison( // NOPMD - acceptable complexity
      @NonNull ISequence&lt;? extends IAnyAtomicItem&gt; leftItems,
      @NonNull Operator operator,
      @NonNull ISequence&lt;? extends IAnyAtomicItem&gt; rightItems) {

<span class="fc" id="L99">    IBooleanItem retval = IBooleanItem.FALSE;</span>
<span class="fc bfc" id="L100" title="All 2 branches covered.">    for (IAnyAtomicItem left : leftItems.getValue()) {</span>
<span class="pc bpc" id="L101" title="1 of 2 branches missed.">      assert left != null;</span>
<span class="fc bfc" id="L102" title="All 2 branches covered.">      for (IAnyAtomicItem right : rightItems.getValue()) {</span>
<span class="pc bpc" id="L103" title="1 of 2 branches missed.">        assert right != null;</span>
        IAnyAtomicItem leftCast;
        IAnyAtomicItem rightCast;
<span class="pc bpc" id="L106" title="1 of 2 branches missed.">        if (left instanceof IUntypedAtomicItem) {</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">          if (right instanceof IUntypedAtomicItem) {</span>
<span class="nc" id="L108">            leftCast = IStringItem.cast(left);</span>
<span class="nc" id="L109">            rightCast = IStringItem.cast(right);</span>
          } else {
<span class="nc" id="L111">            leftCast = applyGeneralComparisonCast(right, left);</span>
<span class="nc" id="L112">            rightCast = right;</span>
          }
<span class="pc bpc" id="L114" title="1 of 2 branches missed.">        } else if (right instanceof IUntypedAtomicItem) {</span>
<span class="nc" id="L115">          leftCast = left;</span>
<span class="nc" id="L116">          rightCast = applyGeneralComparisonCast(left, right);</span>
        } else {
<span class="fc" id="L118">          leftCast = left;</span>
<span class="fc" id="L119">          rightCast = right;</span>
        }

<span class="pc bpc" id="L122" title="1 of 2 branches missed.">        assert leftCast != null;</span>
<span class="fc" id="L123">        IBooleanItem result = compare(leftCast, operator, rightCast);</span>
<span class="fc bfc" id="L124" title="All 2 branches covered.">        if (IBooleanItem.TRUE.equals(result)) {</span>
<span class="fc" id="L125">          retval = IBooleanItem.TRUE;</span>
        }
<span class="fc" id="L127">      }</span>
<span class="fc" id="L128">    }</span>
<span class="fc" id="L129">    return retval;</span>
  }

  /**
   * Attempts to cast the provided {@code other} item to the type of the
   * {@code item}.
   *
   * @param item
   *          the item whose type the other item is to be cast to
   * @param other
   *          the item to cast
   * @return the casted item
   */
  @NonNull
  private static IAnyAtomicItem applyGeneralComparisonCast(@NonNull IAnyAtomicItem item,
      @NonNull IAnyAtomicItem other) {
    IAnyAtomicItem retval;
<span class="nc bnc" id="L146" title="All 2 branches missed.">    if (item instanceof INumericItem) {</span>
<span class="nc" id="L147">      retval = IDecimalItem.cast(other);</span>
<span class="nc bnc" id="L148" title="All 2 branches missed.">    } else if (item instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L149">      retval = IDayTimeDurationItem.cast(other);</span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">    } else if (item instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L151">      retval = IYearMonthDurationItem.cast(other);</span>
    } else {
<span class="nc" id="L153">      retval = item.getJavaTypeAdapter().cast(other);</span>
    }
<span class="nc" id="L155">    return retval;</span>
  }

  /**
   * Compare the {@code right} item with the {@code left} item using the specified
   * {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem compare( // NOPMD - unavoidable
      @NonNull IAnyAtomicItem left,
      @NonNull Operator operator,
      @NonNull IAnyAtomicItem right) {
    @NonNull
    IBooleanItem retval;
<span class="pc bpc" id="L177" title="1 of 4 branches missed.">    if (left instanceof IStringItem || right instanceof IStringItem) {</span>
<span class="fc" id="L178">      retval = stringCompare(IStringItem.cast(left), operator, IStringItem.cast(right));</span>
<span class="pc bpc" id="L179" title="1 of 4 branches missed.">    } else if (left instanceof INumericItem &amp;&amp; right instanceof INumericItem) {</span>
<span class="fc" id="L180">      retval = numericCompare((INumericItem) left, operator, (INumericItem) right);</span>
<span class="pc bpc" id="L181" title="2 of 4 branches missed.">    } else if (left instanceof IBooleanItem &amp;&amp; right instanceof IBooleanItem) {</span>
<span class="fc" id="L182">      retval = booleanCompare((IBooleanItem) left, operator, (IBooleanItem) right);</span>
<span class="nc bnc" id="L183" title="All 4 branches missed.">    } else if (left instanceof IDateTimeItem &amp;&amp; right instanceof IDateTimeItem) {</span>
<span class="nc" id="L184">      retval = dateTimeCompare((IDateTimeItem) left, operator, (IDateTimeItem) right);</span>
<span class="nc bnc" id="L185" title="All 4 branches missed.">    } else if (left instanceof IDateItem &amp;&amp; right instanceof IDateItem) {</span>
<span class="nc" id="L186">      retval = dateCompare((IDateItem) left, operator, (IDateItem) right);</span>
<span class="nc bnc" id="L187" title="All 4 branches missed.">    } else if (left instanceof IDurationItem &amp;&amp; right instanceof IDurationItem) {</span>
<span class="nc" id="L188">      retval = durationCompare((IDurationItem) left, operator, (IDurationItem) right);</span>
<span class="nc bnc" id="L189" title="All 4 branches missed.">    } else if (left instanceof IBase64BinaryItem &amp;&amp; right instanceof IBase64BinaryItem) {</span>
<span class="nc" id="L190">      retval = binaryCompare((IBase64BinaryItem) left, operator, (IBase64BinaryItem) right);</span>
    } else {
<span class="nc" id="L192">      throw new InvalidTypeMetapathException(</span>
          null,
<span class="nc" id="L194">          String.format(&quot;invalid types for comparison: %s %s %s&quot;, left.getClass().getName(),</span>
<span class="nc" id="L195">              operator.name().toLowerCase(Locale.ROOT), right.getClass().getName()));</span>
    }
<span class="fc" id="L197">    return retval;</span>
  }

  /**
   * Perform a string-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem stringCompare(@NonNull IStringItem left, @NonNull Operator operator,
      @NonNull IStringItem right) {
<span class="fc" id="L215">    int result = left.compareTo(right);</span>
    boolean retval;
<span class="pc bpc" id="L217" title="1 of 7 branches missed.">    switch (operator) {</span>
    case EQ:
      // retval = OperationFunctions.opNumericEqual(left.compare(right),
      // IIntegerItem.ZERO);
<span class="fc bfc" id="L221" title="All 2 branches covered.">      retval = result == 0;</span>
<span class="fc" id="L222">      break;</span>
    case GE:
      // retval = OperationFunctions.opNumericGreaterThan(left.compare(right),
      // IIntegerItem.NEGATIVE_ONE);
<span class="fc bfc" id="L226" title="All 2 branches covered.">      retval = result &gt;= 0;</span>
<span class="fc" id="L227">      break;</span>
    case GT:
      // retval = OperationFunctions.opNumericGreaterThan(left.compare(right),
      // IIntegerItem.ZERO);
<span class="fc bfc" id="L231" title="All 2 branches covered.">      retval = result &gt; 0;</span>
<span class="fc" id="L232">      break;</span>
    case LE:
      // retval = OperationFunctions.opNumericLessThan(left.compare(right),
      // IIntegerItem.ONE);
<span class="fc bfc" id="L236" title="All 2 branches covered.">      retval = result &lt;= 0;</span>
<span class="fc" id="L237">      break;</span>
    case LT:
      // retval = OperationFunctions.opNumericLessThan(left.compare(right),
      // IIntegerItem.ZERO);
<span class="fc bfc" id="L241" title="All 2 branches covered.">      retval = result &lt; 0;</span>
<span class="fc" id="L242">      break;</span>
    case NE:
      // retval = FnNot.fnNot(OperationFunctions.opNumericEqual(left.compare(right),
      // IIntegerItem.ZERO));
<span class="fc bfc" id="L246" title="All 2 branches covered.">      retval = result != 0;</span>
<span class="fc" id="L247">      break;</span>
    default:
<span class="nc" id="L249">      throw new IllegalArgumentException(</span>
<span class="nc" id="L250">          String.format(&quot;Unsupported operator '%s'&quot;, operator.name())); // NOPMD</span>
    }
<span class="fc" id="L252">    return IBooleanItem.valueOf(retval);</span>
  }

  /**
   * Perform a number-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem numericCompare(@NonNull INumericItem left, @NonNull Operator operator,
      @NonNull INumericItem right) {
    IBooleanItem retval;
<span class="pc bpc" id="L271" title="6 of 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="fc" id="L273">      retval = OperationFunctions.opNumericEqual(left, right);</span>
<span class="fc" id="L274">      break;</span>
    case GE: {
<span class="nc" id="L276">      IBooleanItem gt = OperationFunctions.opNumericGreaterThan(left, right);</span>
<span class="nc" id="L277">      IBooleanItem eq = OperationFunctions.opNumericEqual(left, right);</span>
<span class="nc bnc" id="L278" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L279">      break;</span>
    }
    case GT:
<span class="nc" id="L282">      retval = OperationFunctions.opNumericGreaterThan(left, right);</span>
<span class="nc" id="L283">      break;</span>
    case LE: {
<span class="nc" id="L285">      IBooleanItem lt = OperationFunctions.opNumericLessThan(left, right);</span>
<span class="nc" id="L286">      IBooleanItem eq = OperationFunctions.opNumericEqual(left, right);</span>
<span class="nc bnc" id="L287" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L288">      break;</span>
    }
    case LT:
<span class="nc" id="L291">      retval = OperationFunctions.opNumericLessThan(left, right);</span>
<span class="nc" id="L292">      break;</span>
    case NE:
<span class="nc" id="L294">      retval = FnNot.fnNot(OperationFunctions.opNumericEqual(left, right));</span>
<span class="nc" id="L295">      break;</span>
    default:
<span class="nc" id="L297">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="fc" id="L299">    return retval;</span>
  }

  /**
   * Perform a boolean-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem booleanCompare(@NonNull IBooleanItem left, @NonNull Operator operator,
      @NonNull IBooleanItem right) {
    IBooleanItem retval;
<span class="pc bpc" id="L318" title="1 of 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="fc" id="L320">      retval = OperationFunctions.opBooleanEqual(left, right);</span>
<span class="fc" id="L321">      break;</span>
    case GE: {
<span class="fc" id="L323">      IBooleanItem gt = OperationFunctions.opBooleanGreaterThan(left, right);</span>
<span class="fc" id="L324">      IBooleanItem eq = OperationFunctions.opBooleanEqual(left, right);</span>
<span class="pc bpc" id="L325" title="2 of 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="fc" id="L326">      break;</span>
    }
    case GT:
<span class="fc" id="L329">      retval = OperationFunctions.opBooleanGreaterThan(left, right);</span>
<span class="fc" id="L330">      break;</span>
    case LE: {
<span class="fc" id="L332">      IBooleanItem lt = OperationFunctions.opBooleanLessThan(left, right);</span>
<span class="fc" id="L333">      IBooleanItem eq = OperationFunctions.opBooleanEqual(left, right);</span>
<span class="pc bpc" id="L334" title="2 of 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="fc" id="L335">      break;</span>
    }
    case LT:
<span class="fc" id="L338">      retval = OperationFunctions.opBooleanLessThan(left, right);</span>
<span class="fc" id="L339">      break;</span>
    case NE:
<span class="fc" id="L341">      retval = FnNot.fnNot(OperationFunctions.opBooleanEqual(left, right));</span>
<span class="fc" id="L342">      break;</span>
    default:
<span class="nc" id="L344">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="fc" id="L346">    return retval;</span>
  }

  /**
   * Perform a date and time-based comparison of the {@code right} item against
   * the {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem dateTimeCompare(@NonNull IDateTimeItem left, @NonNull Operator operator,
      @NonNull IDateTimeItem right) {
    IBooleanItem retval;
<span class="nc bnc" id="L365" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L367">      retval = OperationFunctions.opDateTimeEqual(left, right);</span>
<span class="nc" id="L368">      break;</span>
    case GE: {
<span class="nc" id="L370">      IBooleanItem gt = OperationFunctions.opDateTimeGreaterThan(left, right);</span>
<span class="nc" id="L371">      IBooleanItem eq = OperationFunctions.opDateTimeEqual(left, right);</span>
<span class="nc bnc" id="L372" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L373">      break;</span>
    }
    case GT:
<span class="nc" id="L376">      retval = OperationFunctions.opDateTimeGreaterThan(left, right);</span>
<span class="nc" id="L377">      break;</span>
    case LE: {
<span class="nc" id="L379">      IBooleanItem lt = OperationFunctions.opDateTimeLessThan(left, right);</span>
<span class="nc" id="L380">      IBooleanItem eq = OperationFunctions.opDateTimeEqual(left, right);</span>
<span class="nc bnc" id="L381" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L382">      break;</span>
    }
    case LT:
<span class="nc" id="L385">      retval = OperationFunctions.opDateTimeLessThan(left, right);</span>
<span class="nc" id="L386">      break;</span>
    case NE:
<span class="nc" id="L388">      retval = FnNot.fnNot(OperationFunctions.opDateTimeEqual(left, right));</span>
<span class="nc" id="L389">      break;</span>
    default:
<span class="nc" id="L391">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="nc" id="L393">    return retval;</span>
  }

  /**
   * Perform a date-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem dateCompare(@NonNull IDateItem left, @NonNull Operator operator,
      @NonNull IDateItem right) {
    IBooleanItem retval;
<span class="nc bnc" id="L412" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L414">      retval = OperationFunctions.opDateEqual(left, right);</span>
<span class="nc" id="L415">      break;</span>
    case GE: {
<span class="nc" id="L417">      IBooleanItem gt = OperationFunctions.opDateGreaterThan(left, right);</span>
<span class="nc" id="L418">      IBooleanItem eq = OperationFunctions.opDateEqual(left, right);</span>
<span class="nc bnc" id="L419" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L420">      break;</span>
    }
    case GT:
<span class="nc" id="L423">      retval = OperationFunctions.opDateGreaterThan(left, right);</span>
<span class="nc" id="L424">      break;</span>
    case LE: {
<span class="nc" id="L426">      IBooleanItem lt = OperationFunctions.opDateLessThan(left, right);</span>
<span class="nc" id="L427">      IBooleanItem eq = OperationFunctions.opDateEqual(left, right);</span>
<span class="nc bnc" id="L428" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L429">      break;</span>
    }
    case LT:
<span class="nc" id="L432">      retval = OperationFunctions.opDateLessThan(left, right);</span>
<span class="nc" id="L433">      break;</span>
    case NE:
<span class="nc" id="L435">      retval = FnNot.fnNot(OperationFunctions.opDateEqual(left, right));</span>
<span class="nc" id="L436">      break;</span>
    default:
<span class="nc" id="L438">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="nc" id="L440">    return retval;</span>
  }

  /**
   * Perform a duration-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem durationCompare( // NOPMD - unavoidable
      @NonNull IDurationItem left,
      @NonNull Operator operator,
      @NonNull IDurationItem right) {
<span class="nc" id="L460">    IBooleanItem retval = null;</span>
<span class="nc bnc" id="L461" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L463">      retval = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc" id="L464">      break;</span>
    case GE:
<span class="nc bnc" id="L466" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L467">        IBooleanItem gt = OperationFunctions.opYearMonthDurationGreaterThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc" id="L470">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L471" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc bnc" id="L472" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L473">        IBooleanItem gt = OperationFunctions.opDayTimeDurationGreaterThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
<span class="nc" id="L476">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L477" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L478">      }</span>
      break;
    case GT:
<span class="nc bnc" id="L481" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L482">        retval = OperationFunctions.opYearMonthDurationGreaterThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc bnc" id="L485" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L486">        retval = OperationFunctions.opDayTimeDurationGreaterThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
      }
      break;
    case LE:
<span class="nc bnc" id="L492" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L493">        IBooleanItem lt = OperationFunctions.opYearMonthDurationLessThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc" id="L496">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L497" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc bnc" id="L498" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L499">        IBooleanItem lt = OperationFunctions.opDayTimeDurationLessThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
<span class="nc" id="L502">        IBooleanItem eq = OperationFunctions.opDurationEqual(left, right);</span>
<span class="nc bnc" id="L503" title="All 4 branches missed.">        retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L504">      }</span>
      break;
    case LT:
<span class="nc bnc" id="L507" title="All 4 branches missed.">      if (left instanceof IYearMonthDurationItem &amp;&amp; right instanceof IYearMonthDurationItem) {</span>
<span class="nc" id="L508">        retval = OperationFunctions.opYearMonthDurationLessThan(</span>
            (IYearMonthDurationItem) left,
            (IYearMonthDurationItem) right);
<span class="nc bnc" id="L511" title="All 4 branches missed.">      } else if (left instanceof IDayTimeDurationItem &amp;&amp; right instanceof IDayTimeDurationItem) {</span>
<span class="nc" id="L512">        retval = OperationFunctions.opDayTimeDurationLessThan(</span>
            (IDayTimeDurationItem) left,
            (IDayTimeDurationItem) right);
      }
      break;
    case NE:
<span class="nc" id="L518">      retval = FnNot.fnNot(OperationFunctions.opDurationEqual(left, right));</span>
<span class="nc" id="L519">      break;</span>
    default:
<span class="nc" id="L521">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }

<span class="nc bnc" id="L524" title="All 2 branches missed.">    if (retval == null) {</span>
<span class="nc" id="L525">      throw new InvalidTypeMetapathException(</span>
          null,
<span class="nc" id="L527">          String.format(&quot;The item types '%s' and '%s' are not comparable&quot;,</span>
<span class="nc" id="L528">              left.getClass().getName(),</span>
<span class="nc" id="L529">              right.getClass().getName()));</span>
    }
<span class="nc" id="L531">    return retval;</span>
  }

  /**
   * Perform a binary data-based comparison of the {@code right} item against the
   * {@code left} item using the specified {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param operator
   *          the comparison operator
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IBooleanItem binaryCompare(@NonNull IBase64BinaryItem left, @NonNull Operator operator,
      @NonNull IBase64BinaryItem right) {
    IBooleanItem retval;
<span class="nc bnc" id="L550" title="All 7 branches missed.">    switch (operator) {</span>
    case EQ:
<span class="nc" id="L552">      retval = OperationFunctions.opBase64BinaryEqual(left, right);</span>
<span class="nc" id="L553">      break;</span>
    case GE: {
<span class="nc" id="L555">      IBooleanItem gt = OperationFunctions.opBase64BinaryGreaterThan(left, right);</span>
<span class="nc" id="L556">      IBooleanItem eq = OperationFunctions.opBase64BinaryEqual(left, right);</span>
<span class="nc bnc" id="L557" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(gt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L558">      break;</span>
    }
    case GT:
<span class="nc" id="L561">      retval = OperationFunctions.opBase64BinaryGreaterThan(left, right);</span>
<span class="nc" id="L562">      break;</span>
    case LE: {
<span class="nc" id="L564">      IBooleanItem lt = OperationFunctions.opBase64BinaryLessThan(left, right);</span>
<span class="nc" id="L565">      IBooleanItem eq = OperationFunctions.opBase64BinaryEqual(left, right);</span>
<span class="nc bnc" id="L566" title="All 4 branches missed.">      retval = IBooleanItem.valueOf(lt.toBoolean() || eq.toBoolean());</span>
<span class="nc" id="L567">      break;</span>
    }
    case LT:
<span class="nc" id="L570">      retval = OperationFunctions.opBase64BinaryLessThan(left, right);</span>
<span class="nc" id="L571">      break;</span>
    case NE:
<span class="nc" id="L573">      retval = FnNot.fnNot(OperationFunctions.opBase64BinaryEqual(left, right));</span>
<span class="nc" id="L574">      break;</span>
    default:
<span class="nc" id="L576">      throw new IllegalArgumentException(String.format(&quot;Unsupported operator '%s'&quot;, operator.name()));</span>
    }
<span class="nc" id="L578">    return retval;</span>
  }

  /**
   * Compare the {@code right} item with the {@code left} item using the specified
   * {@code operator}.
   *
   * @param left
   *          the value to compare against
   * @param right
   *          the value to compare with
   * @return the comparison result
   */
  @NonNull
  public static IIntegerItem compareTo(
      @NonNull IAnyAtomicItem left,
      @NonNull IAnyAtomicItem right) {
<span class="nc" id="L595">    return IIntegerItem.valueOf(left.compareTo(right));</span>
  }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>